<div class="space-y-6">
  <!-- Active Status -->
  <div class="p-4 bg-gray-50 rounded-lg">
    <div class="flex items-center">
      <%= f.check_box :active, class: "h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded" %>
      <label class="ml-2 block text-sm font-medium text-gray-900">Set as Active Listing</label>
    </div>
    <p class="mt-1 text-xs text-gray-500">Only one rental listing can be active at a time. Activating this will deactivate any other active rental listing.</p>
  </div>

  <!-- Visibility Flags -->
  <div>
    <h4 class="text-sm font-medium text-gray-700 mb-3">Visibility Settings</h4>
    <div class="grid grid-cols-2 gap-4">
      <div class="flex items-center">
        <%= f.check_box :visible, class: "h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded" %>
        <label class="ml-2 block text-sm text-gray-900">Visible on Website</label>
      </div>
      <div class="flex items-center">
        <%= f.check_box :highlighted, class: "h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded" %>
        <label class="ml-2 block text-sm text-gray-900">Highlighted/Featured</label>
      </div>
      <div class="flex items-center">
        <%= f.check_box :reserved, class: "h-4 w-4 text-yellow-600 focus:ring-yellow-500 border-gray-300 rounded" %>
        <label class="ml-2 block text-sm text-gray-900">Reserved</label>
      </div>
      <div class="flex items-center">
        <%= f.check_box :furnished, class: "h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" %>
        <label class="ml-2 block text-sm text-gray-900">Furnished</label>
      </div>
    </div>
  </div>

  <!-- Rental Type -->
  <div>
    <h4 class="text-sm font-medium text-gray-700 mb-3">Rental Type</h4>
    <div class="flex space-x-6">
      <div class="flex items-center">
        <%= f.check_box :for_rent_short_term, class: "h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded" %>
        <label class="ml-2 block text-sm text-gray-900">Short Term (Vacation)</label>
      </div>
      <div class="flex items-center">
        <%= f.check_box :for_rent_long_term, class: "h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded" %>
        <label class="ml-2 block text-sm text-gray-900">Long Term</label>
      </div>
    </div>
  </div>

  <!-- Pricing -->
  <div>
    <h4 class="text-sm font-medium text-gray-700 mb-3">Pricing</h4>
    <div class="space-y-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Monthly Rent</label>
        <div class="flex space-x-2">
          <%= f.number_field :price_rental_monthly_current_cents,
              value: listing.price_rental_monthly_current_cents.to_i > 0 ? listing.price_rental_monthly_current_cents / 100.0 : nil,
              step: 0.01, min: 0,
              class: "flex-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm",
              placeholder: "Enter monthly rent..." %>
          <%= f.select :price_rental_monthly_current_currency,
              [['EUR', 'EUR'], ['USD', 'USD'], ['GBP', 'GBP']],
              { selected: listing.price_rental_monthly_current_currency || 'EUR' },
              class: "w-24 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm" %>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Low Season Price</label>
          <%= f.number_field :price_rental_monthly_low_season_cents,
              value: listing.price_rental_monthly_low_season_cents.to_i > 0 ? listing.price_rental_monthly_low_season_cents / 100.0 : nil,
              step: 0.01, min: 0,
              class: "block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm",
              placeholder: "Low season..." %>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">High Season Price</label>
          <%= f.number_field :price_rental_monthly_high_season_cents,
              value: listing.price_rental_monthly_high_season_cents.to_i > 0 ? listing.price_rental_monthly_high_season_cents / 100.0 : nil,
              step: 0.01, min: 0,
              class: "block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm",
              placeholder: "High season..." %>
        </div>
      </div>
      <p class="text-xs text-gray-500">Seasonal pricing is typically used for short-term/vacation rentals.</p>
    </div>
  </div>

  <!-- Listing Text (Title & Description) -->
  <div>
    <h4 class="text-sm font-medium text-gray-700 mb-3">Listing Text</h4>
    <% I18n.available_locales.each do |locale| %>
      <div class="mb-4 p-4 border border-gray-200 rounded-lg">
        <h5 class="text-sm font-medium text-gray-600 mb-2"><%= locale.to_s.upcase %></h5>
        <div class="space-y-3">
          <div>
            <label class="block text-sm text-gray-700 mb-1">Title</label>
            <%= f.text_field "title_#{locale}",
                value: listing.send("title_#{locale}"),
                class: "block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm",
                placeholder: "Enter title in #{locale.to_s.upcase}..." %>
          </div>
          <div>
            <label class="block text-sm text-gray-700 mb-1">Description</label>
            <%= f.text_area "description_#{locale}",
                value: listing.send("description_#{locale}"),
                rows: 3,
                class: "block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 sm:text-sm",
                placeholder: "Enter description in #{locale.to_s.upcase}..." %>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Price Guessing Game -->
  <div class="mt-8 p-6 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-200">
    <div class="flex items-center mb-4">
      <span class="text-2xl mr-3">ðŸŽ¯</span>
      <h4 class="text-lg font-semibold text-purple-900">Guess the Rent Game</h4>
    </div>

    <% if listing.game_enabled? %>
      <!-- Game is enabled -->
      <div class="mb-4">
        <p class="text-sm text-purple-700 mb-3">
          Share this link on social media to let visitors guess the monthly rent!
        </p>
        <div class="flex items-center gap-2">
          <input type="text"
                 value="<%= price_game_url(listing.game_token) %>"
                 readonly
                 class="flex-1 px-3 py-2 bg-white border border-purple-200 rounded-lg text-sm text-gray-700"
                 id="game-url-<%= listing.id %>">
          <button type="button"
                  onclick="navigator.clipboard.writeText(document.getElementById('game-url-<%= listing.id %>').value).then(() => { this.textContent = 'Copied!'; setTimeout(() => { this.textContent = 'Copy'; }, 2000); })"
                  class="px-4 py-2 bg-purple-600 text-white text-sm font-medium rounded-lg hover:bg-purple-700 transition">
            Copy
          </button>
          <a href="<%= price_game_path(listing.game_token) %>"
             target="_blank"
             class="px-4 py-2 bg-white border border-purple-300 text-purple-700 text-sm font-medium rounded-lg hover:bg-purple-50 transition">
            Preview
          </a>
        </div>
      </div>

      <!-- Game Analytics -->
      <div class="grid grid-cols-3 gap-4 mb-4">
        <div class="bg-white rounded-lg p-3 text-center">
          <p class="text-2xl font-bold text-purple-700"><%= listing.game_views_count %></p>
          <p class="text-xs text-gray-500">Views</p>
        </div>
        <div class="bg-white rounded-lg p-3 text-center">
          <p class="text-2xl font-bold text-purple-700"><%= listing.game_guesses_count %></p>
          <p class="text-xs text-gray-500">Guesses</p>
        </div>
        <div class="bg-white rounded-lg p-3 text-center">
          <p class="text-2xl font-bold text-purple-700"><%= listing.game_shares_count %></p>
          <p class="text-xs text-gray-500">Shares</p>
        </div>
      </div>

      <%= link_to disable_game_site_admin_prop_rental_listing_path(@realty_asset, listing),
                  method: :patch,
                  class: "inline-flex items-center text-sm text-red-600 hover:text-red-800",
                  data: { confirm: "Are you sure you want to disable the game? Existing guesses will be preserved." } do %>
        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"/>
        </svg>
        Disable Game
      <% end %>
    <% else %>
      <!-- Game is not enabled -->
      <p class="text-sm text-gray-600 mb-4">
        Create a shareable "Guess the Rent" game for this listing. Visitors can try to guess the monthly rent - great for social media engagement!
      </p>
      <%= link_to enable_game_site_admin_prop_rental_listing_path(@realty_asset, listing),
                  method: :patch,
                  class: "inline-flex items-center px-4 py-2 bg-purple-600 text-white text-sm font-medium rounded-lg hover:bg-purple-700 transition" do %>
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        Enable Game Mode
      <% end %>
    <% end %>
  </div>
</div>
